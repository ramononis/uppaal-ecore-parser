plugins {
    id 'java-library'
    id "org.xtext.xtend" version "2.0.2"
}
apply plugin: 'eclipse'

eclipse {
    classpath {
      file {
            whenMerged {
                def source = entries.find { it.path == 'main/java' }
                source.entryAttributes['ignore_optional_problems'] = 'true'
            }
        }
    }
}

sourceSets {
	main {
		java {
			srcDir 'main/java'
			srcDir 'main/src-gen'
			srcDir '../UppaalEMF/requirements/org.muml.uppaal.requirements/src'
			srcDir '../UppaalEMF/metamodel/nl.utwente.ewi.fmt.uppaalsmc/src'
			srcDir '../UppaalEMF/metamodel/org.muml.uppaal/src'
			srcDir '../UppaalEMF/serializer/org.muml.uppaal.serialization/src'
		}
		resources {
			srcDirs "main/src-gen"
		}
	}
}
sourceSets.main.resources.filter.include('**/*.xtextbin', '**/*.g', '**/*.tokens')
repositories {
    mavenCentral()
	maven {
		url 'https://repo.eclipse.org/content/groups/releases'
	}

}


dependencies {
	compile group: 'org.eclipse.core', name: 'org.eclipse.core.runtime', version: '3.7.0'
	compile group: 'org.eclipse.emf', name: 'org.eclipse.emf.common', version: '2.15.0'
	compile group: 'org.eclipse.emf', name: 'org.eclipse.emf.ecore', version: '2.15.0'
	compile group: 'org.eclipse.xtext', name: 'org.eclipse.xtext', version: '2.16.0'

	compile group: 'org.eclipse.emf', name: 'org.eclipse.emf.mwe2.launch', version: '2.9.1.201705291010'
	compile group: 'org.eclipse.xtext', name: 'org.eclipse.xtext.common.types', version: '2.16.0'
	compile group: 'org.eclipse.xtext', name: 'org.eclipse.xtext.xtext.generator', version: '2.16.0'
	compile group: 'org.eclipse.ocl', name: 'org.eclipse.ocl.common', version: '1.2.0.v20140610-0641'
	compile group: 'org.eclipse.ocl', name: 'org.eclipse.ocl.ecore', version: '3.3.100.v20140610-0641'

    // Use JUnit test framework
    testImplementation 'junit:junit:4.12'
}

task xText(type: JavaExec) {
	main = 'org.eclipse.emf.mwe2.launch.runtime.Mwe2Launcher'
	classpath = configurations.compile
	classpath += sourceSets.main.runtimeClasspath
	classpath += files("../UppaalEMF/metamodel/org.muml.uppaal/src")
	classpath += files("../UppaalEMF/metamodel/nl.utwente.ewi.fmt.uppaalsmc/src")
	inputs.file "main/java/nl/utwente/ewi/fmt/uppaalSMC/parser/GenerateUppaalSMC.mwe2"
	inputs.file "main/java/nl/utwente/ewi/fmt/uppaalSMC/parser/UppaalSMC.xtext"
	args += "main/java/nl/utwente/ewi/fmt/uppaalSMC/parser/GenerateUppaalSMC.mwe2"
}
